Index: util/i386/pc/grub-setup.c
===================================================================
--- util/i386/pc/grub-setup.c	(revision 2220)
+++ util/i386/pc/grub-setup.c	(working copy)
@@ -56,6 +56,7 @@ static const grub_gpt_part_type_t grub_g

 #define DEFAULT_BOOT_FILE	"boot.img"
 #define DEFAULT_CORE_FILE	"core.img"
+#define CORE_IMG_IN_FS		"setup_left_core_image_in_filesystem"

 #define grub_target_to_host16(x)	grub_le_to_cpu16(x)
 #define grub_target_to_host32(x)	grub_le_to_cpu32(x)
@@ -413,6 +414,8 @@ setup (const char *dir,
 		       boot_img))
     grub_util_error ("%s", grub_errmsg);

+  unlink (DEFAULT_DIRECTORY "/" CORE_IMG_IN_FS);
+
   goto finish;

 unable_to_embed:
@@ -427,6 +430,9 @@ unable_to_embed:
   if (! force)
     grub_util_error (_("if you really want blocklists, use --force"));

+  fp = fopen (DEFAULT_DIRECTORY "/" CORE_IMG_IN_FS, "w");
+  fclose (fp);
+
   /* Make sure that GRUB reads the identical image as the OS.  */
   tmp_img = xmalloc (core_size);
   core_path_dev_full = grub_util_get_path (dir, core_file);
